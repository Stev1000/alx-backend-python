#!/bin/bash

# kurbeScript - Kubernetes Cluster Setup and Verification

# Check if minikube is installed
if ! command -v minikube &> /dev/null; then
    echo "minikube is not installed"
    exit 1
fi

# Check if kubectl is installed  
if ! command -v kubectl &> /dev/null; then
    echo "kubectl is not installed"
    exit 1
fi

# Start Docker if needed (for WSL)
if ! docker ps &>/dev/null; then
    sudo service docker start
    sleep 3
fi

# Start minikube cluster
if ! minikube status &>/dev/null; then
    minikube start --driver=docker
fi

# Wait for cluster to be ready
kubectl wait --for=condition=Ready nodes --all --timeout=300s

# Verify cluster is running using kubectl cluster-info
kubectl cluster-info

# Retrieve available pods
kubectl get pods --all-namespaces

echo "Kubernetes cluster setup completed"
