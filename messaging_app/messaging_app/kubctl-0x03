#!/bin/bash
# Script to apply rolling update for messaging_app

# Apply the updated blue deployment
kubectl apply -f messaging_app/messaging_app/blue_deployment.yaml

# Monitor rollout progress
kubectl rollout status deployment/blue-deployment

# Continuously send requests to check for downtime
for i in {1..10}; do
  curl -s http://$(minikube ip):30000/ || echo "Request failed"
  sleep 2
done

# Show final pod status
kubectl get pods -l app=messaging-app -o wide
